问题： 在公司开发网环境下是内网，从外部传文件很不方便，需要通过邮件到办公网，再转发送到开发网。而且，邮件的附件大小有限制，不能传大文件。

条件： 开发网虽然有网络限制，但是有 npm 私有库，可以获取外部依赖。

解决方案：通过 npm 私有库，上传文件，并通过内部网络，下载到开发网。受众是非技术，可以做一个网站解决方案，有两部分组成：
1. 外网
   1.1 网站上传文件，可以拖拽、点击、断点续传，或者支持提供 在线 url 地址
   1.2 外网服务端接受到文件后，使用 npm 发布，（因 npm 大文件效率问题）大文件需要拆分成多个包，并使用 npm 的 tag 机制? 或是 npm 的 alpha 不同版本，来传输一个完整的包。
2. 内网
   2.1 内网服务端使用定时脚本，获取外网 npm 对应的包 是否有更新，有更新则将该批文件（可能多包）下载到内网，并合并成一个文件。
   2.2 建设内网用于接受 文件的 网站，并提供下载。


潜在考虑点：
1. 用户在网站需要有个标志，希望是可���生成一份4位数的随机码，这个码 用来关联 npm 的包，以及内网用同样的码，来下载文件。
2. 内网用户如果已经下载过文件，删除内网服务端的文件，如果下载失败，则重新下载。
3. 如果用户三天内没有从内网下载，则删除文件。



## 关于 npm 文件的思考

### 1. 包结构

- **统筹包 (Coordinator Package)**:
  - **命名约定**: 使用 `build-core-part-tow@YYYY.MM.DD-alpha.X` 格式，其中 `X` 表示当天的上传序号。
  - **内容**: 包含 `index.json` 文件，记录：
    - `code`: 上传的唯一识别码。
    - `fileList`: 文件列表，每项包含：
      - `name`: 文件块的 npm 包名。
      - `version`: 文件块的版本号。

- **存储包 (Storage Packages)**:
  - **命名约定**: 使用 `build-core-part-tow-sub@YYYY.MM.DD-X.YY` 格式，其中 `X` 为上传序号，`YY` 为文件块编号。
  - **内容**: 存储文件数据的实际内容。

### 2. 文件上传流程

- **生成唯一识别码**: 为每次上传生成一个唯一的识别码。
- **拆分大文件**: 如果文件超过指定大小，拆分为更小的块。
- **创建并发布包**:
  - 发布包含 `index.json` 的统筹包。
  - 为每个文件块发布存储包。

### 3. 文件下载流程

- **获取统筹包**: 使用唯一识别码查找并下载统筹包。
- **解析 `index.json`**: 提取存储包列表。
- **下载并重组文件**: 下载每个存储包并重组文件（如有拆分）。

### 4. 错误处理与验证

- **完整性检查**: 实施校验和或哈希以验证下载后的文件完整性。
- **重试机制**: 处理网络错误并实现重试逻辑。

### 5. 安全与访问控制

- **访问控制**: 确保只有授权用户可以上传和下载文件。
- **数据加密**: 考虑在上传到 npm 前加密文件。

### 6. 清理与维护

- **自动清理**: 实施脚本在指定时间后（如3天）删除旧包。
- **日志与监控**: 记录上传和下载活动日志以便审计和故障排除。





